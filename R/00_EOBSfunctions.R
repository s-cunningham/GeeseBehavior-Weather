
# Function to insert punctuation into e-obs dates so that it can be read by POSIXct function

library(tidyverse)

dateConvert <- function(x) {
  if (nchar(x)==8){
    x <- gsub('^([0-9]{2})([0-9]{2})([0-9]{4})$', '\\1-\\2-\\3', x) 
  } else if (nchar(x)==6) {
    x <- gsub('^([0-9]{1})([0-9]{1})([0-9]{4})$', '0\\10\\2\\3', x)
    x <- gsub('^([0-9]{2})([0-9]{2})([0-9]{4})$', '\\1-\\2-\\3', x)
  } else if ((nchar(x)==7) & (substr(x,3,3)>2)) {
    x <- gsub('^([0-9]{2})([0-9]{1})([0-9]{4})$', '\\10\\2\\3', x)
    x <- gsub('^([0-9]{2})([0-9]{2})([0-9]{4})$', '\\1-\\2-\\3', x)
  } else if ((nchar(x)==7) & (substr(x,3,3)==0)) {
    x <- gsub('^([0-9]{1})([0-9]{2})([0-9]{4})$', '0\\1\\2\\3', x)
    x <- gsub('^([0-9]{2})([0-9]{2})([0-9]{4})$', '\\1-\\2-\\3', x)
  } else if ((nchar(x)==7) & (substr(x,1,1)>3)) {
    x <- gsub('^([0-9]{1})([0-9]{2})([0-9]{4})$', '0\\1\\2\\3', x)
    x <- gsub('^([0-9]{2})([0-9]{2})([0-9]{4})$', '\\1-\\2-\\3', x)
  } else if ((nchar(x)==7) & (substr(x,2,2)==0)) {
    x <- gsub('^([0-9]{1})([0-9]{2})([0-9]{4})$', '\\10\\2\\3', x)
    x <- gsub('^([0-9]{2})([0-9]{2})([0-9]{4})$', '\\1-\\2-\\3', x)
  } else if ((nchar(x)==7) & (substr(x,2,2)==9)) {
    x <- gsub('^([0-9]{2})([0-9]{1})([0-9]{4})$', '\\10\\2\\3', x)
    x <- gsub('^([0-9]{2})([0-9]{2})([0-9]{4})$', '\\1-\\2-\\3', x)
  } else if ((nchar(x)==7) & (substr(x,2,3)>12)) {
    x <- gsub('^([0-9]{2})([0-9]{1})([0-9]{4})$', '\\10\\2\\3', x)
    x <- gsub('^([0-9]{2})([0-9]{2})([0-9]{4})$', '\\1-\\2-\\3', x)
  } else if (nchar(x)==7) {
    p1 <- max(which(temp$date==x)) + 1
    n <- as.character(temp$date[p1])
    if (substr(n,1,1)>substr(x,1,1)) {
      x <- gsub('^([0-9]{1})([0-9]{2})([0-9]{4})$', '0\\1\\2\\3', x)
      x <- gsub('^([0-9]{2})([0-9]{2})([0-9]{4})$', '\\1-\\2-\\3', x)
    } else if (substr(n,2,2)>substr(x,2,2)) {
      x <- gsub('^([0-9]{2})([0-9]{1})([0-9]{4})$', '\\10\\2\\3', x)
      x <- gsub('^([0-9]{2})([0-9]{2})([0-9]{4})$', '\\1-\\2-\\3', x)
    } 
  } 
}



